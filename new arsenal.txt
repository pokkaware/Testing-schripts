--[[
    Mobile Arsenal Hybrid: OffenseWare x PandazWare
    - Logic: Closest Distance (3D) BUT inside FOV Circle
    - FOV: Static Center
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-[span_0](start_span)- // 1. LIBRARY LADEN[span_0](end_span) //
local LibraryURL = "https://raw.githubusercontent.com/PandazWare/PandazWare/refs/heads/main/PandazWare%20libary"
local success, PandazWare = pcall(function()
    return loadstring(game:HttpGet(LibraryURL))()
end)

if not success or not PandazWare then return warn("Lib failed") end

-- // CONFIGURATION //
getgenv().Config = {
    Aimbot = {
        Enabled = false,
        FOV = 100,
        Smoothing = 0.5,
        WallCheck = true,
        [span_1](start_span)Parts = {Head = true, UpperTorso = false} --[span_1](end_span)
    },
    ESP = {
        Enabled = false,
        Boxes = true,
        Skeletons = true,
        Tracers = false,
        Names = false,
        Health = false,
        Chams = false
    },
    [span_2](start_span)Fly = { Enabled = false, Speed = 50 }, --[span_2](end_span)
    [span_3](start_span)Gun = { InfAmmo = false, FastFire = false, NoRecoil = false } --[span_3](end_span)
}

-- // UTILS //
local function IsEnemy(plr)
    if not plr or not plr.Team then return true end
    return plr.Team ~= LocalPlayer.Team
end

local function IsVisible(targetPart)
    if not Config.Aimbot.WallCheck then return true end
    local origin = Camera.CFrame.Position
    local direction = targetPart.Position - origin
    local params = RaycastParams.new()
    params.FilterDescendantsInstances = {LocalPlayer.Character, Camera}
    params.FilterType = Enum.RaycastFilterType.Exclude; params.IgnoreWater = true
    [span_4](start_span)local result = Workspace:Raycast(origin, direction, params) -- [cite: 31-32]
    return not result or result.Instance:IsDescendantOf(targetPart.Parent)
end

-- // AIMBOT LOGIC (DISTANCE WITHIN FOV) //
local FOVCircle = Drawing.new("Circle")
FOVCircle.Visible = false
[cite_start]FOVCircle.Color = Color3.fromRGB(130, 80, 200) -- Binxix Style[span_4](end_span)
FOVCircle.Thickness = 1.5
FOVCircle.NumSides = 30
FOVCircle.Filled = false

local function GetClosestTarget()
    local closestPart = nil
    local shortestDistance3D = math.huge -- Wir suchen die kürzeste 3D Distanz
    
    local CenterScreen = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
    local MyPos = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and LocalPlayer.Character.HumanoidRootPart.Position
    
    if not MyPos then return nil end

    for _, v in pairs(Players:GetPlayers()) do
        if v ~= LocalPlayer and IsEnemy(v) and v.Character then
            [span_5](start_span)for partName, enabled in pairs(Config.Aimbot.Parts) do -- [cite: 32-33]
                if enabled then
                    local part = v.Character:FindFirstChild(partName)
                    local hum = v.Character:FindFirstChild("Humanoid")
                    
                    if part and hum and hum.Health > 0 then
                        local pos, onScreen = Camera:WorldToViewportPoint(part.Position)
                        if onScreen then
                            -- 1. Prüfen: Ist Spieler im FOV-Kreis?
                            local distToCenter = (Vector2.new(pos.X, pos.Y) - CenterScreen).Magnitude
                            
                            if distToCenter <= Config.Aimbot.FOV then
                                -- 2. Prüfen: Ist er sichtbar (wenn Wallcheck an)?
                                if IsVisible(part) then
                                    -- 3. Entscheiden: Wer ist mir KÖRPERLICH am nächsten?
                                    local dist3D = (part.Position - MyPos).Magnitude
                                    
                                    if dist3D < shortestDistance3D then
                                        shortestDistance3D = dist3D
                                        closestPart = part
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return closestPart
end

RunService.RenderStepped:Connect(function()
    local CenterScreen = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
    FOVCircle.Position = CenterScreen
    FOVCircle.Radius = Config.Aimbot.FOV
    [cite_start]FOVCircle.Visible = Config.Aimbot.Enabled -- [cite: 38-39]

    if Config.Aimbot.Enabled then
        local target = GetClosestTarget()
        if target then
            Camera.CFrame = Camera.CFrame:Lerp(CFrame.new(Camera.CFrame.Position, target.Position), Config.Aimbot.Smoothing)
        end
    end
end)

[cite_start]-- // FLY (OFFENSEWARE) [cite: 45-48] //
local fbv, fbg
local function ToggleFly(s)
    if s then
        if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then return end
        local hrp = LocalPlayer.Character.HumanoidRootPart
        fbv = Instance.new("BodyVelocity", hrp); fbv.MaxForce = Vector3.new(1e5,1e5,1e5)
        fbg = Instance.new("BodyGyro", hrp); fbg.MaxTorque = Vector3.new(1e5,1e5,1e5)
        LocalPlayer.Character.Humanoid.PlatformStand = true
    else
        if fbv then fbv:Destroy() end; if fbg then fbg:Destroy() end
        if LocalPlayer.Character then LocalPlayer.Character.Humanoid.PlatformStand = false end
    end
end

RunService.Heartbeat:Connect(function()
    if Config.Fly.Enabled and fbv then
        local cam = workspace.CurrentCamera
        local mv = LocalPlayer.Character.Humanoid.MoveDirection
        local fd = (cam.CFrame.LookVector * mv.Z * -1) + (cam.CFrame.RightVector * mv.X)
        fbv.Velocity = mv.Magnitude == 0 and Vector3.zero or fd * Config.Fly.Speed
        fbg.CFrame = cam.CFrame
    end
end)

[cite_start]-- // GUN MODS (OFFENSEWARE) [cite: 40-44] //
task.spawn(function()
    local wkspc = ReplicatedStorage:WaitForChild("wkspc", 5)
    local Weapons = ReplicatedStorage:WaitForChild("Weapons", 5)
    while task.wait(1.5) do
        if Config.Gun.InfAmmo or Config.Gun.FastFire or Config.Gun.NoRecoil then
            pcall(function()
                if Config.Gun.InfAmmo and wkspc and wkspc:FindFirstChild("CurrentCurse") then 
                    if wkspc.CurrentCurse.Value ~= "Infinite Ammo" then wkspc.CurrentCurse.Value = "Infinite Ammo" end 
                end
                if Weapons then 
                    for _, v in ipairs(Weapons:GetChildren()) do
                        if Config.Gun.FastFire then 
                            local fr = v:FindFirstChild("FireRate"); if fr and fr.Value > 0.04 then fr.Value = 0.04 end
                            local a = v:FindFirstChild("Auto"); if a then a.Value = true end 
                        end
                        if Config.Gun.NoRecoil then 
                            local rc = v:FindFirstChild("RecoilControl"); if rc and rc.Value ~= 0 then rc.Value = 0 end
                            local sp = v:FindFirstChild("Spread"); if sp and sp.Value ~= 0 then sp.Value = 0 end 
                        end
                    end 
                end
            end)
        end
    end
end)
--[[
    Mobile Arsenal Hybrid: Part 2 (ESP)
    - Logic: OffenseWare Drawings
    - Colors: Binxix
]]

local ESP_Storage = {}
local Colors = {
    [cite_start]Visible = Color3.fromRGB(0, 255, 200), --[span_5](end_span)
    [span_6](start_span)Hidden = Color3.fromRGB(255, 80, 80),  --[span_6](end_span)
    Skeleton = Color3.fromRGB(255, 255, 255)
}

[span_7](start_span)local function CreateLine() --[span_7](end_span)
    local l = Drawing.new("Line")
    l.Thickness = 1.5
    l.Color = Color3.new(1,1,1)
    l.Transparency = 1
    l.Visible = false
    return l
end

local function CreateESP(plr)
    if ESP_Storage[plr] then return end
    
    [span_8](start_span)local BGui = Instance.new("BillboardGui") --[span_8](end_span)
    BGui.Name = "MobESP"
    BGui.AlwaysOnTop = true
    BGui.Size = UDim2.new(4.5,0,6,0)
    
    [span_9](start_span)local Frame = Instance.new("Frame", BGui) --[span_9](end_span)
    Frame.Size = UDim2.new(1,0,1,0)
    Frame.BackgroundTransparency = 1
    
    [span_10](start_span)local Stroke = Instance.new("UIStroke", Frame) --[span_10](end_span)
    Stroke.Color = Colors.Hidden
    Stroke.Thickness = 1.5
    
    [span_11](start_span)local Info = Instance.new("TextLabel", Frame) -- [cite: 8-9]
    Info.Size = UDim2.new(1,0,0,20)
    Info.Position = UDim2.new(0,0,-0.2,0)
    Info.BackgroundTransparency = 1
    Info.TextColor3 = Color3.new(1,1,1)
    Info.Font = Enum.Font.GothamBold
    Info.TextSize = 12
    Info.TextStrokeTransparency = 0
    
    [cite_start]local HBarBG = Instance.new("Frame", Frame) -- [cite: 9-10]
    HBarBG.Size = UDim2.new(0.05,0,1,0)
    HBarBG.Position = UDim2.new(-0.15,0,0,0)
    HBarBG.BackgroundColor3 = Color3.new(0,0,0)
    HBarBG.BorderSizePixel = 0
    
    [cite_start]local HBarFill = Instance.new("Frame", HBarBG) -- [cite: 10-11]
    HBarFill.Size = UDim2.new(1,0,1,0)
    HBarFill.BackgroundColor3 = Color3.new(0,1,0)
    HBarFill.BorderSizePixel = 0

    local Tracer = CreateLine()
    local Skeleton = { 
        Head_Torso = CreateLine(), Torso_LArm = CreateLine(), Torso_RArm = CreateLine(), 
        Torso_LLeg = CreateLine(), Torso_RLeg = CreateLine() 
    [cite_start]} -- [cite: 20-27]

    ESP_Storage[plr] = {Gui = BGui, Stroke = Stroke, Info = Info, HBarBG = HBarBG, HBarFill = HBarFill, Tracer = Tracer, Skeleton = Skeleton, Highlight = nil}
end

[cite_start]local function RemoveESP(plr) --[span_11](end_span)
    local obj = ESP_Storage[plr]
    if obj then
        if obj.Gui then obj.Gui:Destroy() end
        if obj.Tracer then obj.Tracer:Remove() end
        for _, l in pairs(obj.Skeleton) do l:Remove() end
        if obj.Highlight then obj.Highlight:Destroy() end
        ESP_Storage[plr] = nil
    end
end

[span_12](start_span)local function UpdateESP() --[span_12](end_span)
    for plr, obj in pairs(ESP_Storage) do
        if not plr.Parent or not plr.Character or not Config.ESP.Enabled or not IsEnemy(plr) then
            obj.Gui.Parent = nil
            obj.Tracer.Visible = false
            for _, l in pairs(obj.Skeleton) do l.Visible = false end
            if obj.Highlight then obj.Highlight.Enabled = false end
        else
            local char = plr.Character
            local hrp = char:FindFirstChild("HumanoidRootPart")
            local head = char:FindFirstChild("Head")
            local hum = char:FindFirstChild("Humanoid")
            
            [span_13](start_span)if hrp and head and hum and hum.Health > 0 then --[span_13](end_span)
                local pos, onScreen = Camera:WorldToViewportPoint(hrp.Position)
                local isVis = IsVisible(head)
                local mainColor = isVis and Colors.Visible or Colors.Hidden
                
                obj.Gui.Parent = game.CoreGui
                obj.Gui.Adornee = hrp
                obj.Stroke.Enabled = Config.ESP.Boxes
                obj.Stroke.Color = mainColor
                
                local txt = ""
                [span_14](start_span)if Config.ESP.Names then txt = plr.Name end --[span_14](end_span)
                obj.Info.Text = txt
                
                [span_15](start_span)if Config.ESP.Health then -- [cite: 16-17]
                    obj.HBarBG.Visible = true
                    local hp = math.clamp(hum.Health / hum.MaxHealth, 0, 1)
                    obj.HBarFill.Size = UDim2.new(1,0,hp,0)
                    obj.HBarFill.Position = UDim2.new(0,0,1-hp,0)
                    obj.HBarFill.BackgroundColor3 = Color3.fromHSV(hp*0.3,1,1)
                else 
                    obj.HBarBG.Visible = false 
                end
                
                [cite_start]if Config.ESP.Chams then --[span_15](end_span)
                    if not obj.Highlight then 
                        obj.Highlight = Instance.new("Highlight", char)
                        obj.Highlight.FillColor = Colors.Hidden
                        obj.Highlight.OutlineColor = Color3.new(1,1,1)
                        obj.Highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop 
                    end
                    obj.Highlight.Enabled = true
                    obj.Highlight.FillColor = mainColor
                elseif obj.Highlight then 
                    obj.Highlight.Enabled = false 
                end

                if onScreen then
                    [span_16](start_span)if Config.ESP.Tracers then --[span_16](end_span)
                        obj.Tracer.From = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y)
                        obj.Tracer.To = Vector2.new(pos.X, pos.Y)
                        obj.Tracer.Color = mainColor
                        obj.Tracer.Visible = true 
                    else 
                        obj.Tracer.Visible = false 
                    end
                    
                    [cite_start]if Config.ESP.Skeletons then -- [cite: 21-27]
                        local function W(p) local x = Camera:WorldToViewportPoint(p.Position); return Vector2.new(x.X, x.Y) end
                        local T = char:FindFirstChild("UpperTorso") or char:FindFirstChild("Torso")
                        local LA = char:FindFirstChild("LeftUpperArm") or char:FindFirstChild("Left Arm")
                        local RA = char:FindFirstChild("RightUpperArm") or char:FindFirstChild("Right Arm")
                        local LL = char:FindFirstChild("LeftUpperLeg") or char:FindFirstChild("Left Leg")
                        local RL = char:FindFirstChild("RightUpperLeg") or char:FindFirstChild("Right Leg")
                        
                        if T and LA and RA and LL and RL then
                            local HP, TP = W(head), W(T)
                            local function DrawL(line, p1, p2) line.From = p1; line.To = p2; line.Visible = true; line.Color = Colors.Skeleton end
                            DrawL(obj.Skeleton.Head_Torso, HP, TP)
                            DrawL(obj.Skeleton.Torso_LArm, TP, W(LA))
                            DrawL(obj.Skeleton.Torso_RArm, TP, W(RA))
                            DrawL(obj.Skeleton.Torso_LLeg, TP, W(LL))
                            DrawL(obj.Skeleton.Torso_RLeg, TP, W(RL))
                        else 
                            for _, l in pairs(obj.Skeleton) do l.Visible = false end 
                        end
                    else 
                        for _, l in pairs(obj.Skeleton) do l.Visible = false end 
                    end
                else 
                    obj.Tracer.Visible = false; for _, l in pairs(obj.Skeleton) do l.Visible = false end 
                end
            else 
                obj.Gui.Parent = nil; obj.Tracer.Visible = false; for _, l in pairs(obj.Skeleton) do l.Visible = false end 
            end
        end
    end
end

RunService.RenderStepped:Connect(UpdateESP)
Players.PlayerAdded:Connect(CreateESP)
Players.PlayerRemoving:Connect(RemoveESP)
for _, p in pairs(Players:GetPlayers()) do if p ~= LocalPlayer then CreateESP(p) end end
--[[
    Mobile Arsenal Hybrid: Part 3 (UI)
]]

local Window = PandazWare:CreateWindow({Title = "Arsenal | Distance Priority"})

-- COMBAT TAB
local Combat = Window:CreateTab("Combat")
Combat:Toggle("Aimbot Active", false, function(v) Config.Aimbot.Enabled = v end)
Combat:Slider("FOV Radius", 10, 400, 100, function(v) Config.Aimbot.FOV = v end)
Combat:Slider("Smoothing", 0, 100, 50, function(v) Config.Aimbot.Smoothing = v/100 end)
Combat:Button("--- Target: Nearest (Distance) ---", function() end)
Combat:Toggle("Aim Head", true, function(v) Config.Aimbot.Parts.Head = v end)
Combat:Toggle("Aim Torso", false, function(v) Config.Aimbot.Parts.UpperTorso = v end)

-- VISUALS TAB
local Visuals = Window:CreateTab("Visuals")
Visuals:Toggle("ESP Master", false, function(v) Config.ESP.Enabled = v end)
Visuals:Toggle("Boxes", true, function(v) Config.ESP.Boxes = v end)
Visuals:Toggle("Skeletons", true, function(v) Config.ESP.Skeletons = v end)
Visuals:Toggle("Tracers", false, function(v) Config.ESP.Tracers = v end)
Visuals:Toggle("Names", false, function(v) Config.ESP.Names = v end)
Visuals:Toggle("Health Bar", false, function(v) Config.ESP.Health = v end)
Visuals:Toggle("Chams", false, function(v) Config.ESP.Chams = v end)

-- GUN TAB
local Gun = Window:CreateTab("Gun Mods")
Gun:Toggle("Infinite Ammo", false, function(v) Config.Gun.InfAmmo = v end)
Gun:Toggle("Fast Fire", false, function(v) Config.Gun.FastFire = v end)
Gun:Toggle("No Recoil", false, function(v) Config.Gun.NoRecoil = v end)

-- MOVEMENT TAB
local Move = Window:CreateTab("Movement")
Move:Toggle("Fly (Mobile)", false, function(v) 
    Config.Fly.Enabled = v
    ToggleFly(v)
end)
Move:Slider("Fly Speed", 10, 200, 50, function(v) Config.Fly.Speed = v end)

PandazWare:Notify("Success", "PandazWare Loaded!", 3)

